module Main;

import Lib;

// Cross-file usage of Yielded in Equality constraint
collect_iter : [iter : MyIterator, MyIterator::Yielded iter = I64] iter -> Array I64;
collect_iter = |it| (
    loop(([], it), |(acc, it)| (
        match it.advance {
            none() => break $ acc,
            some((next_it, val)) => continue $ (acc.push_back(val), next_it)
        }
    ))
);

main : IO ();
main = (
    let it = MyIter { idx: 0 };
    let _ = sum_iter(it);
    pure()
);
